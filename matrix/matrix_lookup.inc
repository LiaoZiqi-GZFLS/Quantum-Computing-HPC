#include <complex>
#include <cstdint>

struct MatKey {
    std::complex<double> d00, d01, d10, d11;
    std::uint8_t p;
};

constexpr MatKey kAll[192] = {
    { std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), 1 },//H 0
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 0.0), 0 },//X 1
    { std::complex<double>(0.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 0.0), 0 },//Y 2
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 0.0), 0 },//Z 3
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 1.0), 0 },//S 4
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 0.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 0.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, -1.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, -1.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 0.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 0.0), 0 },//I 36
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, -1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, -1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, -1.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 1.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 0.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 0.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 1.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 0.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 0.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, -1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 1.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, -1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 1.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 1.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(0.0, 1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), std::complex<double>(1.0, 0.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, 1.0), std::complex<double>(0.0, -1.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), std::complex<double>(0.0, 1.0), std::complex<double>(1.0, 0.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(0.0, -1.0), std::complex<double>(-1.0, 0.0), std::complex<double>(-1.0, 0.0), std::complex<double>(0.0, -1.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), 0 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, -1.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, -1.0), 1 },
    { std::complex<double>(1.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, -1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(1.0, -1.0), 1 },
    { std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(0.0, 0.0), 1 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, 1.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(0.0, 0.0), std::complex<double>(0.0, 0.0), std::complex<double>(-1.0, -1.0), 1 },
    { std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(-1.0, 1.0), std::complex<double>(1.0, -1.0), 0 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), 0 },
    { std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(1.0, -1.0), std::complex<double>(-1.0, 1.0), 0 },
    { std::complex<double>(-1.0, -1.0), std::complex<double>(1.0, 1.0), std::complex<double>(-1.0, -1.0), std::complex<double>(-1.0, -1.0), 0 }
};

inline int lookupMatrix(const std::complex<double> d[2][2], std::uint8_t p)
{
    for (int i = 0; i < 192; ++i)
        if (kAll[i].p == p &&
            kAll[i].d00 == d[0][0] &&
            kAll[i].d01 == d[0][1] &&
            kAll[i].d10 == d[1][0] &&
            kAll[i].d11 == d[1][1])
            return i;
    return -1;   // not found
}
